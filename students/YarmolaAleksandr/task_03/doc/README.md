# –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 03. –ê—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç—å –∏ HTTP-–∫—ç—à

**–í–∞—Ä–∏–∞–Ω—Ç 23:** –†–µ–π—Ç–∏–Ω–≥–∏ –∏–≥—Ä/—Ñ–∏–ª—å–º–æ–≤ —Å –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ–º
**–°—Ç—É–¥–µ–Ω—Ç:** –Ø—Ä–º–æ–ª–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä

---

## –û–ø–∏—Å–∞–Ω–∏–µ

–í–µ–±-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –ø–æ–∏—Å–∫–∞ –¢–í-—à–æ—É —Å async/await, retry, —Ç–∞–π–º–∞—É—Ç–∞–º–∏, AbortController –∏ in-memory –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º —Å TTL.

### –†–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–≤—ë—Ä–Ω—É—Ç–æ –Ω–∞ GitHub Pages:
üîó **[–î–µ–º–æ](https://alexsandro007.github.io/all_tasks_v23/task_03/src/index.html)**

![Preview](./screenshots/preview.png)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
task_03/
‚îú‚îÄ‚îÄ src/          # index.html, main.js, styles.css
‚îî‚îÄ‚îÄ doc/          # README.md, screenshots/
```

---

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

### 1. –ö–ª–∏–µ–Ω—Ç –∫ API ‚úÖ

**API:** TVMaze (https://api.tvmaze.com) ‚Äî –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π, –±–µ–∑ –∫–ª—é—á–µ–π, 240,000+ —Å–µ—Ä–∏–∞–ª–æ–≤

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**
- –ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–∏—Å–∫–∞ (12 —ç–ª–µ–º–µ–Ω—Ç–æ–≤/—Å—Ç—Ä–∞–Ω–∏—Ü–∞)
- –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é
- –ü–∞–≥–∏–Ω–∞—Ü–∏—è
- –°–æ—Å—Ç–æ—è–Ω–∏—è: loading (skeleton) / error / empty

### 2. Retry –∏ —Ç–∞–π–º–∞—É—Ç—ã ‚úÖ

**–†–µ–∞–ª–∏–∑–∞—Ü–∏—è `fetchWithRetry(url, { retries, backoffMs, timeoutMs })`:**

```javascript
async function fetchWithRetry(url, options = {}) {
    const { retries = 3, backoffMs = 1000, timeoutMs = 10000, signal } = options;

    for (let attempt = 0; attempt <= retries; attempt++) {
        const timeoutController = new AbortController();
        const timeoutId = setTimeout(() => timeoutController.abort(), timeoutMs);

        try {
            const response = await fetch(url, { signal: signal || timeoutController.signal });
            clearTimeout(timeoutId);
            if (!response.ok) throw new Error(`HTTP ${response.status}`);
            return await response.json();
        } catch (error) {
            clearTimeout(timeoutId);
            if (error.name === 'AbortError') throw error;
            if (attempt < retries) {
                await sleep(backoffMs * Math.pow(2, attempt)); // 1s ‚Üí 2s ‚Üí 4s
            }
        }
    }
    throw new Error('–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ 3 –ø–æ–ø—ã—Ç–æ–∫');
}
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- 3 –ø–æ–ø—ã—Ç–∫–∏
- –≠–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞: 1s ‚Üí 2s ‚Üí 4s
- –¢–∞–π–º–∞—É—Ç: 10 —Å–µ–∫—É–Ω–¥ –Ω–∞ –ø–æ–ø—ã—Ç–∫—É
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ "–ü–æ–≤—Ç–æ—Ä–Ω–∞—è –ø–æ–ø—ã—Ç–∫–∞ 1/3..."

### 3. AbortController (–æ—Ç–º–µ–Ω–∞ –∑–∞–ø—Ä–æ—Å–æ–≤) ‚úÖ

```javascript
class GamesAPI {
    async fetchGames(searchQuery, page, ignoreCache) {
        // –û—Ç–º–µ–Ω—è–µ–º –ø—Ä–µ–¥—ã–¥—É—â–∏–π –∑–∞–ø—Ä–æ—Å
        if (this.abortController) {
            this.abortController.abort();
        }
        this.abortController = new AbortController();

        const data = await fetchWithRetry(url, {
            signal: this.abortController.signal
        });
        return data;
    }
}
```

**–ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ:** –ø—Ä–∏ –Ω–æ–≤–æ–º –ø–æ–∏—Å–∫–µ —Å—Ç–∞—Ä—ã–π –∑–∞–ø—Ä–æ—Å –æ—Ç–º–µ–Ω—è–µ—Ç—Å—è, –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞—è race conditions.

### 4. –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ

**In-memory Map —Å TTL (5 –º–∏–Ω—É—Ç):**

```javascript
class SimpleCache {
    constructor(ttl = 5 * 60 * 1000) {
        this.cache = new Map();
        this.ttl = ttl;
    }

    set(key, value) {
        this.cache.set(key, { value, timestamp: Date.now() });
    }

    get(key) {
        const item = this.cache.get(key);
        if (!item) return null;

        const age = Date.now() - item.timestamp;
        if (age > this.ttl) {
            this.cache.delete(key);
            return null;
        }
        return item.value;
    }
}
```

**–ö–ª—é—á:** `shows_${query}_${page}`
**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:** —É—Å–∫–æ—Ä–µ–Ω–∏–µ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –≤ 100-300 —Ä–∞–∑

### 5. UX-—É–ª—É—á—à–µ–Ω–∏—è ‚úÖ

- –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å" (–∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∫—ç—à)
- –ö–Ω–æ–ø–∫–∞ "–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à"
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞: –∑–∞–ø–∏—Å–µ–π –≤ –∫—ç—à–µ, —Å—á—ë—Ç—á–∏–∫ –∑–∞–ø—Ä–æ—Å–æ–≤
- Skeleton-–∑–∞–≥—Ä—É–∑—á–∏–∫–∏ (6 –∫–∞—Ä—Ç–æ—á–µ–∫)
- –ò–Ω–¥–∏–∫–∞—Ç–æ—Ä retry

### 6. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è ‚úÖ

- async/await —Å try/catch/finally
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω–∫—É—Ä–µ–Ω—Ç–Ω—ã–º–∏ –∑–∞–ø—Ä–æ—Å–∞–º–∏ (–æ—Ç–º–µ–Ω–∞ –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö)
- –ù–µ–±–ª–æ–∫–∏—Ä—É—é—â–∏–π UI (skeleton)

---

## –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏—è –≤ DevTools

### –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å

![–ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å](./screenshots/first-request.png)

**Network:**
- Status: `200 OK`
- Time: ~600ms
- Size: ~50KB

**Console:** `üåê –ó–∞–ø—Ä–æ—Å –∫ API: https://api.tvmaze.com/shows?page=0`

### –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –∑–∞–ø—Ä–æ—Å (–∏–∑ –∫—ç—à–∞)

![–ö—ç—à](./screenshots/cached-request.png)

**Network:** –∑–∞–ø—Ä–æ—Å –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
**Console:** `‚úÖ –î–∞–Ω–Ω—ã–µ –≤–∑—è—Ç—ã –∏–∑ –∫—ç—à–∞: shows__1`
**Time:** ~2ms (–≤ 300x –±—ã—Å—Ç—Ä–µ–µ!)

### Retry –ø—Ä–∏ –æ—à–∏–±–∫–µ

![Retry](./screenshots/retry-mechanism_1.png)

![Retry](./screenshots/retry-mechanism_2.png)

**–¢–µ—Å—Ç:** DevTools ‚Üí Network ‚Üí Offline

**–†–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ü–æ–ø—ã—Ç–∫–∞ 1 (0s)
- –ü–æ–ø—ã—Ç–∫–∞ 2 (–∑–∞–¥–µ—Ä–∂–∫–∞ 1s)
- –ü–æ–ø—ã—Ç–∫–∞ 3 (–∑–∞–¥–µ—Ä–∂–∫–∞ 2s)
- –ü–æ–ø—ã—Ç–∫–∞ 4 (–∑–∞–¥–µ—Ä–∂–∫–∞ 4s)
- –û—à–∏–±–∫–∞: "–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –¥–∞–Ω–Ω—ã–µ –ø–æ—Å–ª–µ 3 –ø–æ–ø—ã—Ç–æ–∫"

### –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ

![–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ](./screenshots/force-refresh.png)

–ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å" ‚Üí –∏–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∫—ç—à ‚Üí –Ω–æ–≤—ã–π –∑–∞–ø—Ä–æ—Å ‚Üí –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫—ç—à–∞

---

## –ú–µ—Ç—Ä–∏–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

| –ú–µ—Ç—Ä–∏–∫–∞ | –ü–µ—Ä–≤—ã–π –∑–∞–ø—Ä–æ—Å | –ò–∑ –∫—ç—à–∞ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|---------------|---------|-----------|
| –í—Ä–µ–º—è | ~600ms | ~2ms | **300x** |
| –†–∞–∑–º–µ—Ä | ~50KB | 0KB | **100%** |
| –ó–∞–ø—Ä–æ—Å–æ–≤ | 1 | 0 | ‚Äî |

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

| –°—Ü–µ–Ω–∞—Ä–∏–π | –†–µ–∑—É–ª—å—Ç–∞—Ç |
|----------|-----------|
| –ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ | ‚úÖ Skeleton ‚Üí —Å–ø–∏—Å–æ–∫ |
| –ü–æ–∏—Å–∫ "Friends" | ‚úÖ –ù–∞—Ö–æ–¥–∏—Ç —Å–µ—Ä–∏–∞–ª—ã |
| –ü–æ–≤—Ç–æ—Ä–Ω—ã–π –ø–æ–∏—Å–∫ | ‚úÖ –ò–∑ –∫—ç—à–∞ <10ms |
| –ü–∞–≥–∏–Ω–∞—Ü–∏—è | ‚úÖ –†–∞–±–æ—Ç–∞–µ—Ç |
| Offline —Ä–µ–∂–∏–º | ‚úÖ 3 retry ‚Üí –æ—à–∏–±–∫–∞ |
| –ë—ã—Å—Ç—Ä–∞—è —Å–º–µ–Ω–∞ –∑–∞–ø—Ä–æ—Å–æ–≤ | ‚úÖ –°—Ç–∞—Ä—ã–µ –æ—Ç–º–µ–Ω—è—é—Ç—Å—è |
| –ö–Ω–æ–ø–∫–∞ "–û–±–Ω–æ–≤–∏—Ç—å" | ‚úÖ –ò–≥–Ω–æ—Ä–∏—Ä—É–µ—Ç –∫—ç—à |
| –ö–Ω–æ–ø–∫–∞ "–û—á–∏—Å—Ç–∏—Ç—å –∫—ç—à" | ‚úÖ –û—á–∏—â–∞–µ—Ç |

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```javascript
CONFIG = {
    BASE_URL: 'https://api.tvmaze.com',
    PAGE_SIZE: 12,
    RETRY_ATTEMPTS: 3,
    TIMEOUT_MS: 10000,
    CACHE_TTL_MS: 300000
}

class SimpleCache { ... }           // –ö—ç—à —Å TTL
class GamesAPI { ... }              // API –∫–ª–∏–µ–Ω—Ç
class GamesUI { ... }               // UI —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ
fetchWithRetry(url, options) { ... } // Retry + timeout
```

---

## –ö—Ä–∏—Ç–µ—Ä–∏–∏ –æ—Ü–µ–Ω–∏–≤–∞–Ω–∏—è

| –ö—Ä–∏—Ç–µ—Ä–∏–π | –ë–∞–ª–ª—ã | –†–µ–∞–ª–∏–∑–∞—Ü–∏—è |
|----------|-------|------------|
| –°–µ–º–∞–Ω—Ç–∏–∫–∞/UX | 20 | HTML5, –∞–¥–∞–ø—Ç–∏–≤–Ω–æ—Å—Ç—å, skeleton |
| –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å | 25 | –ó–∞–≥—Ä—É–∑–∫–∞, –ø–æ–∏—Å–∫, –ø–∞–≥–∏–Ω–∞—Ü–∏—è, retry, timeout, abort, –∫—ç—à |
| –ö–∞—á–µ—Å—Ç–≤–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ | 20 | Loading/error/empty, skeleton, —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ |
| –ö–∞—á–µ—Å—Ç–≤–æ –∫–æ–¥–∞ | 15 | Classes, async/await, try/catch/finally |
| –í–∞–ª–∏–¥–∞—Ü–∏—è | 10 | –ö—ç—à —Ä–∞–±–æ—Ç–∞–µ—Ç, –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–æ |
| –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∏ –æ—Ç—á—ë—Ç | 10 | README + —Å–∫—Ä–∏–Ω—à–æ—Ç—ã |

**–ë–æ–Ω—É—Å—ã:**
- –û—Ç–º–µ–Ω–∞ —É—Å—Ç–∞—Ä–µ–≤—à–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (AbortController)
- Skeleton-–∑–∞–≥—Ä—É–∑—á–∏–∫–∏

---

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏

- **Vanilla JavaScript (ES6+):** Classes, async/await, Map
- **Fetch API:** HTTP-–∑–∞–ø—Ä–æ—Å—ã, AbortController
- **TVMaze API:** RESTful API –±–µ–∑ –∫–ª—é—á–µ–π
- **CSS3:** Grid, Flexbox, Animations

---

## –í—ã–≤–æ–¥—ã

–í —Ö–æ–¥–µ —Ä–∞–±–æ—Ç—ã –æ—Å–≤–æ–µ–Ω—ã:
1. Async/await –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (try/catch/finally)
2. Retry —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
3. AbortController –¥–ª—è –æ—Ç–º–µ–Ω—ã –∑–∞–ø—Ä–æ—Å–æ–≤
4. In-memory –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Å TTL
5. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º–∏ UI (loading/error/empty)
6. –†–∞–±–æ—Ç–∞ —Å –≤–Ω–µ—à–Ω–∏–º API (TVMaze)

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** production-ready –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –Ω–∞–¥—ë–∂–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–æ–π –æ—à–∏–±–æ–∫ –∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–º –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º.

---

### Accessibility —É–ª—É—á—à–µ–Ω–∏—è ‚úÖ

- ‚úÖ Semantic HTML (`<article>`, `<section>`, `role` –∞—Ç—Ä–∏–±—É—Ç—ã)
- ‚úÖ Focus management (–≤–∏–¥–∏–º—ã–µ `focus-visible` —Å—Ç–∏–ª–∏)
- ‚úÖ Keyboard navigation (tabindex, ARIA labels)
- ‚úÖ Screen reader support (live regions, announcements)

---

**–ê–≤—Ç–æ—Ä:** –Ø—Ä–º–æ–ª–∞ –ê–ª–µ–∫—Å–∞–Ω–¥—Ä | –ì—Ä—É–ø–ø–∞: –ê–°-63
